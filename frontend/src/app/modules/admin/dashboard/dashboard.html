<div class="dashboard-page">
  <div class="background-decor">
    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>
  </div>

  <div class="dashboard-container">
    <header class="app-header">
      <div class="brand">
        <div class="logo-sm">
          <span class="material-symbols-outlined">school</span>
        </div>
        <span>Creavers Admin</span>
      </div>
      <div class="spacer"></div>
      <button mat-flat-button color="warn" (click)="logout()" class="logout-btn">
        <mat-icon>logout</mat-icon>
        Logout
      </button>
    </header>

    <main class="content-area">
      <mat-card class="main-card">
        <mat-tab-group dynamicHeight>
          <mat-tab label="Teachers">
            <div class="tab-content">
              <div class="tab-header">
                <h3>Teacher Directory</h3>
                <button mat-flat-button color="primary" (click)="addTeacher()">
                  <mat-icon>add</mat-icon> New Teacher
                </button>
              </div>
              <div class="table-container">
                <table mat-table [dataSource]="teachers" class="modern-table">
                  <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef> Name </th>
                    <td mat-cell *matCellDef="let teacher"> {{teacher.name}} </td>
                  </ng-container>
                  <ng-container matColumnDef="email">
                    <th mat-header-cell *matHeaderCellDef> Email </th>
                    <td mat-cell *matCellDef="let teacher"> {{teacher.email}} </td>
                  </ng-container>
                  <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef> Actions </th>
                    <td mat-cell *matCellDef="let teacher">
                      <button mat-icon-button color="primary" (click)="editTeacher(teacher)"><mat-icon>edit</mat-icon></button>
                      <button mat-icon-button color="warn" (click)="deleteTeacher(teacher._id)"><mat-icon>delete</mat-icon></button>
                    </td>
                  </ng-container>
                  <tr mat-header-row *matHeaderRowDef="['name', 'email', 'actions']"></tr>
                  <tr mat-row *matRowDef="let row; columns: ['name', 'email', 'actions'];"></tr>
                </table>
              </div>
            </div>
          </mat-tab>

          <mat-tab label="Students">
            <div class="tab-content">
              <div class="tab-header">
                <h3>Student Roster</h3>
                <button mat-flat-button color="primary" (click)="addStudent()">
                  <mat-icon>add</mat-icon> New Student
                </button>
              </div>
              <div class="table-container">
                <table mat-table [dataSource]="students" class="modern-table">
                  <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef> Name </th>
                    <td mat-cell *matCellDef="let student"> {{student.name}} </td>
                  </ng-container>
                  <ng-container matColumnDef="email">
                    <th mat-header-cell *matHeaderCellDef> Email </th>
                    <td mat-cell *matCellDef="let student"> {{student.email}} </td>
                  </ng-container>
                  <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef> Actions </th>
                    <td mat-cell *matCellDef="let student">
                      <button mat-icon-button color="primary" (click)="editStudent(student)"><mat-icon>edit</mat-icon></button>
                      <button mat-icon-button color="warn" (click)="deleteStudent(student._id)"><mat-icon>delete</mat-icon></button>
                    </td>
                  </ng-container>
                  <tr mat-header-row *matHeaderRowDef="['name', 'email', 'actions']"></tr>
                  <tr mat-row *matRowDef="let row; columns: ['name', 'email', 'actions'];"></tr>
                </table>
              </div>
            </div>
          </mat-tab>

          <mat-tab label="Subjects">
            <div class="tab-content">
              <div class="tab-header">
                <h3>Curriculum</h3>
                <button mat-flat-button color="primary" (click)="addSubject()">
                  <mat-icon>add</mat-icon> New Subject
                </button>
              </div>
              <div class="table-container">
                <table mat-table [dataSource]="subjects" class="modern-table">
                  <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef> Name </th>
                    <td mat-cell *matCellDef="let subject"> {{subject.name}} </td>
                  </ng-container>
                  <ng-container matColumnDef="description">
                    <th mat-header-cell *matHeaderCellDef> Description </th>
                    <td mat-cell *matCellDef="let subject"> {{subject.description}} </td>
                  </ng-container>
                  <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef> Actions </th>
                    <td mat-cell *matCellDef="let subject">
                      <button mat-icon-button color="primary" (click)="editSubject(subject)"><mat-icon>edit</mat-icon></button>
                      <button mat-icon-button color="warn" (click)="deleteSubject(subject._id)"><mat-icon>delete</mat-icon></button>
                    </td>
                  </ng-container>
                  <tr mat-header-row *matHeaderRowDef="['name', 'description', 'actions']"></tr>
                  <tr mat-row *matRowDef="let row; columns: ['name', 'description', 'actions'];"></tr>
                </table>
              </div>
            </div>
          </mat-tab>

          <mat-tab label="Grades">
            <div class="tab-content">
              <div class="tab-header">
                <h3>Academic Classes</h3>
                <button mat-flat-button color="primary" (click)="addGrade()">
                  <mat-icon>add</mat-icon> New Class
                </button>
              </div>
              <div class="table-container">
                <table mat-table [dataSource]="grades" class="modern-table">
                  <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef> Class Name </th>
                    <td mat-cell *matCellDef="let grade"> {{grade.name}} </td>
                  </ng-container>
                  <ng-container matColumnDef="teacher">
                    <th mat-header-cell *matHeaderCellDef> Subject Assignments </th>
                    <td mat-cell *matCellDef="let grade"> 
                      <div class="assignment-chips">
                        <span *ngFor="let st of grade.subjectTeachers" class="st-chip">
                          <strong>{{st.subject?.name}}</strong>: {{st.teacher?.name}}
                        </span>
                      </div>
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef> Actions </th>
                    <td mat-cell *matCellDef="let grade">
                      <button mat-icon-button color="primary" (click)="editGrade(grade)"><mat-icon>edit</mat-icon></button>
                      <button mat-icon-button color="warn" (click)="deleteGrade(grade._id)"><mat-icon>delete</mat-icon></button>
                    </td>
                  </ng-container>
                  <tr mat-header-row *matHeaderRowDef="['name', 'teacher', 'actions']"></tr>
                  <tr mat-row *matRowDef="let row; columns: ['name', 'teacher', 'actions'];"></tr>
                </table>
              </div>
            </div>
          </mat-tab>
        </mat-tab-group>
      </mat-card>
    </main>
  </div>
</div>
